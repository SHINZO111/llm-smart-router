# LLM Smart Router GUI v2.0 ユーザーマニュアル

**バージョン:** 2.0.1-improved  
**最終更新:** 2026年2月3日  
**作者:** クラ for 新さん

---

## 📑 目次

1. [概要](#概要)
2. [インストール](#インストール)
3. [クイックスタート](#クイックスタート)
4. [機能詳細](#機能詳細)
5. [キーボードショートカット](#キーボードショートカット)
6. [トラブルシューティング](#トラブルシューティング)
7. [よくある質問](#よくある質問)

---

## 概要

### LLM Smart Router GUI とは？

**LLM Smart Router GUI** は、ローカルLLM（LM Studio等）とクラウドLLM（Claude）をシームレスに切り替えて利用できる**インテリジェントルーティングシステム**です。

### 主な特徴

| 機能 | 説明 |
|------|------|
| 🧠 **自動判定** | 入力内容に応じて最適なモデルを自動選択 |
| 🏠 **ローカルLLM** | LM Studio等のローカルモデルを活用 |
| ☁️ **Claude連携** | Anthropic Claude APIへのフォールバック |
| 🔐 **セキュア** | APIキーはOS標準の暗号化ストレージに保存 |
| 📊 **統計ダッシュボード** | 使用状況とコストの可視化 |
| 📋 **用途別プリセット** | CM業務・推し活等の専用モード |
| ⌨️ **ショートカット** | 効率的なキーボード操作 |

---

## インストール

### システム要件

| 項目 | 要件 |
|------|------|
| **OS** | Windows 10/11, macOS 12+, Linux |
| **Python** | 3.9 以上 |
| **Node.js** | 18.0 以上 |
| **メモリ** | 8GB 以上推奨 |
| **ディスク** | 500MB 以上の空き容量 |

### インストール手順

#### 1. リポジトリのクローン

```bash
cd F:\
git clone https://github.com/yourusername/llm-smart-router.git
cd llm-smart-router
```

#### 2. 依存関係のインストール

```bash
# Node.js依存
npm install

# Python依存（GUI用）
pip install -r requirements-gui.txt
```

**requirements-gui.txt:**
```
PySide6>=6.4.0
keyring>=24.0.0
cryptography>=41.0.0
pyyaml>=6.0
requests>=2.31.0
psutil>=5.9.0
```

#### 3. 設定ファイルの準備

```bash
copy config.yaml.example config.yaml
```

### 起動方法

#### Windows

```bash
# バッチファイル経由
run_gui.bat

# または直接
python src/gui/main_window.py
```

#### macOS / Linux

```bash
python3 src/gui/main_window.py
```

---

## クイックスタート

### 初回セットアップ

1. **APIキーの設定**
   - 初回起動時に「APIキー未設定」のダイアログが表示されます
   - 「はい」をクリックして設定ダイアログを開きます
   - Anthropic APIキーを入力して保存

2. **ローカルLLMの設定（オプション）**
   - LM Studioを起動
   - サーバーモードで待ち受け設定（デフォルト: http://localhost:1234）

### 基本的な使い方

#### 1. テキスト入力

```
入力欄に質問やタスクを入力
↓
「🚀 実行」ボタンをクリック または Ctrl+Enter
↓
結果が出力欄に表示
```

#### 2. モデル選択

| モード | 使用シーン |
|--------|-----------|
| 🧠 **自動判定** | 日常的な使用（推奨） |
| 🏠 **ローカルLLM** | 機密データ・オフライン環境 |
| ☁️ **Claude** | 高品質が必要な場合 |

#### 3. プリセット活用

入力内容に応じて最適なプリセットが自動選択されます：

- 🏗️ **CM業務** - 建設業のコスト管理・見積
- 💎 **推し活** - 配信スケジュール・応援企画
- 💻 **コーディング** - コード生成・レビュー
- ✍️ **文章作成** - ビジネス文書・SNS投稿
- 📊 **データ分析** - 統計分析・可視化
- 📚 **学習支援** - 知識習得・解説

---

## 機能詳細

### 🎯 モデル選択

#### 自動判定モード

AIが以下の観点で自動的にモデルを選択：

| 入力特徴 | 選択モデル | 理由 |
|----------|-----------|------|
| 長文（5000文字以上） | Claude | 長文処理能力 |
| 機密情報含む | ローカル | プライバシー保護 |
| プログラミング関連 | 自動判定 | 複雑性に応じて |
| 短い質問 | ローカル | レスポンス速度 |

#### 手動切替

1. 「🎯 モデル選択」ドロップダウンをクリック
2. 希望のモデルを選択
3. ステータス表示が変更されます

### 📋 プリセット機能

#### プリセットの選択

```
📋 用途プリセット
  ├─ ✨ 自動検出（デフォルト）
  ├─ 🏗️ CM業務
  ├─ 💎 推し活
  ├─ 💻 コーディング
  ├─ ✍️ 文章作成
  ├─ 📊 データ分析
  └─ 📚 学習支援
```

#### カスタムプリセット

1. 「⚙️ 設定」→「📋 プリセット」タブを選択
2. 編集したいプリセットを選択
3. システムプロンプトを編集
4. 「💾 保存」をクリック

### 📊 統計ダッシュボード

#### 表示項目

| 項目 | 説明 |
|------|------|
| 📈 総リクエスト | セッション中の総リクエスト数 |
| 💰 節約額 | ローカル使用による推定節約額 |
| ☁️ クラウドコスト | Claude API使用コスト |
| 🔄 モデル使用状況 | ローカル/クラウドの使用比率 |
| ⚡ パフォーマンス | 平均応答時間・トークン効率 |

#### 詳細統計の表示

- `Ctrl+D` または 「🛠️ ツール」→「📊 統計表示」
- 実行履歴の確認・エクスポートが可能

### 🔐 セキュリティ

#### APIキー管理

APIキーは以下の方法で安全に保存されます：

| OS | 保存先 |
|----|--------|
| Windows | Windows Credential Manager |
| macOS | Keychain |
| Linux | Secret Service |

#### バックエンド確認

```python
# 使用中のバックエンドを確認
from security.key_manager import SecureKeyManager

manager = SecureKeyManager()
print(manager.get_backend())  # 'windows', 'macos', 'secretservice', 'file'
```

---

## キーボードショートカット

### 基本操作

| ショートカット | 機能 |
|---------------|------|
| `Ctrl+Enter` | 実行 |
| `Ctrl+Shift+Enter` | 停止 |
| `Esc` | 停止/キャンセル |

### ファイル操作

| ショートカット | 機能 |
|---------------|------|
| `Ctrl+N` | 新規 |
| `Ctrl+O` | ファイルを開く |
| `Ctrl+S` | 結果を保存 |

### 編集

| ショートカット | 機能 |
|---------------|------|
| `Ctrl+L` | 入力クリア |
| `Ctrl+Shift+C` | 出力コピー |

### モデル・プリセット

| ショートカット | 機能 |
|---------------|------|
| `Ctrl+M` | モデル切替 |
| `Ctrl+P` | プリセット選択 |

### 表示

| ショートカット | 機能 |
|---------------|------|
| `Ctrl+Plus` | フォント拡大 |
| `Ctrl+Minus` | フォント縮小 |
| `Ctrl+0` | フォントリセット |
| `Ctrl+D` | ダッシュボード表示 |

### 設定・ヘルプ

| ショートカット | 機能 |
|---------------|------|
| `Ctrl+T` | 設定 |
| `F1` | クイックヘルプ |
| `Ctrl+H` | バージョン情報 |
| `Ctrl+Q` | 終了 |

---

## トラブルシューティング

### 🔌 接続エラー

**症状:**
```
🔌 接続エラー
詳細: Failed to connect to API
```

**対処法:**
1. インターネット接続を確認
2. ファイアウォール設定を確認
3. VPN/プロキシ設定を確認

### 🔐 認証エラー

**症状:**
```
🔐 認証エラー
詳細: Invalid API key
```

**対処法:**
1. APIキーが正しく設定されているか確認
2. 「設定」→「APIキー設定」で再設定
3. APIキーの有効期限を確認

### ⏱️ タイムアウト

**症状:**
```
⏱️ タイムアウト
詳細: Request timed out
```

**対処法:**
1. ネットワーク環境が混雑していないか確認
2. リクエストサイズを小さくする
3. 設定でタイムアウト時間を延長

### 🤖 モデルエラー

**症状:**
```
🤖 モデルエラー
詳細: Model not available
```

**対処法:**
1. モデル選択を変更
2. ローカルLLMが起動しているか確認
3. LM Studioの待ち受けポートを確認

### 💾 リソース不足

**症状:**
```
💾 リソース不足
詳細: Memory limit exceeded
```

**対処法:**
1. 不要なアプリケーションを終了
2. ディスク容量を確認
3. システムを再起動

---

## よくある質問

### Q: APIキーは安全に保存されますか？

**A:** はい。APIキーはOS標準の暗号化ストレージに保存されます：
- Windows: Credential Manager
- macOS: Keychain
- Linux: Secret Service

### Q: ローカルLLMとの連携方法は？

**A:** LM Studio等を起動し、サーバーモードで待ち受け状態にします：
1. LM Studioを起動
2. モデルをロード
3. 「Server」タブで「Start Server」をクリック
4. デフォルトポート: 1234

### Q: プリセットの自動検出はどのように動作しますか？

**A:** 入力テキストに含まれるキーワードに基づいて判定します：
- 「コスト」「見積」「工事」→ CM業務
- 「配信」「推し」「ファン」→ 推し活
- 「コード」「バグ」「エラー」→ コーディング

### Q: 統計データはどこに保存されますか？

**A:** 統計データはセッション中のみメモリに保持されます。永続化する場合は「📊 統計表示」→「📤 エクスポート」でJSON形式で保存できます。

### Q: フォントサイズを変更できますか？

**A:** はい。以下のショートカットで変更できます：
- `Ctrl+Plus` (+) で拡大
- `Ctrl+Minus` (-) で縮小
- `Ctrl+0` でリセット

### Q: ログはどこで確認できますか？

**A:** 「🛠️ ツール」→「📜 ログ表示」で確認できます。ログファイルは以下に保存されます：
- Windows: `%USERPROFILE%\.llm-smart-router\logs\`
- macOS/Linux: `~/.llm-smart-router/logs/`

### Q: 改善モジュールを無効にできますか？

**A:** はい。`main_window.py` を使用することで、基本機能のみ使用できます：
```bash
python src/gui/main_window.py
```

---

## サポート

### バグ報告・機能要望

GitHub Issuesにて受け付けています：
https://github.com/yourusername/llm-smart-router/issues

### ログの収集

問題報告時は以下の情報を添付してください：

1. アプリケーションログ
   - 「🛠️ ツール」→「📜 ログ表示」→「📤 エクスポート」

2. エラーログ
   - エラー発生時の詳細情報をコピー

3. 環境情報
   ```
   OS: Windows 11 / macOS 14 / Ubuntu 22.04
   Python: 3.11.0
   Node.js: 20.0.0
   ```

---

## 更新履歴

### v2.0.1 (2026-02-03)
- ✅ GUIパフォーマンス最適化
- ✅ エラーメッセージ改善
- ✅ キーボードショートカット追加
- ✅ ログ機能追加
- ✅ 大規模テキスト処理対応

### v2.0.0 (2026-02-02)
- 🎉 初回リリース
- 🧠 自動モデル判定
- 🔐 APIキー暗号化
- 📊 統計ダッシュボード
- 📋 用途別プリセット

---

**© 2026 クラ for 新さん. All rights reserved.**
